
---
title: "Project 01: Internet Addiction and Common Mental Disorder"
author: "Negar Alizadeh"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    number_sections: true
---

# Introduction
This report summarizes the results from the logistic regression analysis
examining whether higher Internet Addiction Test (IAT) scores are linked with
higher odds of probable Common Mental Disorder (CMD) among Malawian students.

# Methods
A multivariable logistic regression was used, adjusting for:
- Gender  
- Age group  
- Study level  
- Discipline  

CMD was defined as **SRQ-20 ≥ 8**, coded as 1 = probable CMD, 0 = no CMD.

# Results

This section presents the results from the multivariable logistic regression
analysis examining whether higher Internet Addiction Test (IAT) scores are
associated with higher odds of probable CMD, after adjusting for demographic factors.

## Adjusted Odds Ratios
```{r results="asis", echo=FALSE, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(gt)

# Use the odds_ratios data that was read earlier
OR_table <- odds_ratios  # This ensures the odds_ratios.csv file is being used

# Clean and format for readability
OR_clean <- OR_table %>%
  rename(
    Predictor = X,
    Odds_Ratio = OR,
    CI_Lower = `X2.5..`,
    CI_Upper = `X97.5..`
  ) %>%
  mutate(
    Odds_Ratio = round(Odds_Ratio, 2),
    CI_Lower = round(CI_Lower, 2),
    CI_Upper = round(CI_Upper, 2)
  )

# Generate GT table
gt(OR_clean) %>%
  tab_header(
    title = "Adjusted Odds Ratios for Common Mental Disorder (CMD)",
    subtitle = "Results from multivariable logistic regression model"
  ) %>%
  cols_label(
    Predictor = "Predictor",
    Odds_Ratio = "Odds Ratio (OR)",
    CI_Lower = "Lower 95% CI",
    CI_Upper = "Upper 95% CI"
  ) %>%
  fmt_number(columns = c(Odds_Ratio, CI_Lower, CI_Upper), decimals = 2) %>%
  tab_source_note("Note: OR > 1 indicates higher odds of CMD; OR < 1 indicates lower odds.")
```

## Model Performance and Diagnostics
Model calibration and discrimination were assessed using several metrics:
- **Hosmer–Lemeshow goodness-of-fit test**  
- **McFadden pseudo R²**  
- **ROC curve and AUC**  
- **Variance Inflation Factors (VIF)** for multicollinearity  

### Hosmer-Lemeshow Test
```{r echo=FALSE}
library(ResourceSelection)

# Perform Hosmer-Lemeshow test
hoslem <- hoslem.test(model_logit$y, fitted(model_logit), g = 10)
hoslem
```
*The Hosmer-Lemeshow test evaluates the goodness-of-fit of the model. A p-value > 0.05 indicates a good fit.*

### Pseudo R²
```{r echo=FALSE}
# Print pseudo R² measures
library(pscl)
pseudo_r2 <- pR2(model_logit)
pseudo_r2
```
*McFadden&rsquo;s R² is one of the most commonly used pseudo-R² values for logistic regression models. Values closer to 1 indicate better fit.*

### ROC Curve
```{r echo=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("reports/roc_curve.png")
```
*The ROC curve displays the trade-off between sensitivity and specificity. An AUC greater than 0.7 indicates that the model has acceptable discriminative ability.*

### Forest Plot of Odds Ratios
```{r echo=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("reports/forest_plot_OR.png")
```
*The forest plot displays adjusted odds ratios and their 95% confidence intervals for each predictor. A value above 1.0 suggests an increase in the odds of CMD, while a value below 1.0 suggests a decrease.*

### Predicted Probability by IAT Score
```{r echo=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("reports/predicted_prob_CMD_IAT.png")
```
*The predicted probability plot shows how the probability of CMD changes across the range of IAT scores for a typical student (female, age 18–24, undergraduate, health sciences).*

# Interpretation
Students with higher Internet Addiction Test scores showed **increased odds**
of reporting symptoms consistent with a common mental disorder, even after
adjusting for demographics.

The logistic model provided an acceptable fit and reasonable discrimination
(AUC > 0.7). The findings highlight problematic internet use as a
significant correlate of mental health outcomes among Malawian students.

# Reproducibility
All code and data are available at:
[GitHub Repository](https://github.com/Negar-Psy/psychology-data-analysis-R)

```{r, echo=FALSE}
sessionInfo()
```

